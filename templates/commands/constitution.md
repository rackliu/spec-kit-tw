---
description: 從互動式或提供的原則輸入建立或更新專案章程, 確保所有依賴模板保持同步.
handoffs:
  - label: 構建規格
    agent: speckit.specify
    prompt: 基於更新的章程實現功能規格。我想要構建...
---

## 使用者輸入

```text
$ARGUMENTS
```

在繼續之前, 你**必須**考慮使用者輸入(如果不為空).

## 概述

你正在更新位於 `/memory/constitution.md` 的專案章程. 該檔案是一個包含方括號佔位符標記的模板(例如 `[PROJECT_NAME]`、`[PRINCIPLE_1_NAME]`). 你的工作是(a)收集/推導具體值, (b)精確填充模板, 以及(c)將任何修改傳播到相關依賴項中.

遵循此執行流程:

1. 載入位於 `/memory/constitution.md` 的現有章程模板.
   - 識別每個 `[ALL_CAPS_IDENTIFIER]` 形式的佔位符標記.
   **重要提示**: 使用者可能需要比模板中使用的原則更少或更多. 如果指定了數字, 請遵循該數字 - 遵循通用模板. 你將相應地更新文件.

2. 為佔位符收集/推導值: 
   - 如果使用者輸入(對話)提供了值, 則使用它.
   - 否則從現有倉庫上下文推斷(README、文件、先前的章程版本(如果嵌入)).
   - 對於治理日期: `RATIFICATION_DATE` 是原始採用日期(如果未知, 請詢問或標記 TODO), `LAST_AMENDED_DATE` 是今天(如果進行了更改), 否則保留之前的日期.
   - `CONSTITUTION_VERSION` 必須根據語義版本控制規則遞增: 
     * MAJOR(主版本): 向後不相容的治理/原則刪除或重新定義.
     * MINOR(次版本): 新原則/部分新增或實質性擴充套件指導.
     * PATCH(補丁版本): 澄清、措辭、拼寫錯誤修復、非語義最佳化.
   - 如果版本遞增型別不明確, 請在最終確定之前提出理由.

3. 起草更新後的章程內容: 
   - 用具體文字替換每個佔位符(除了專案選擇尚未定義的故意保留的模板槽位外, 不留下括號標記——明確說明任何保留的槽位).
   - 保留標題層次結構, 一旦替換可以刪除註釋, 除非它們仍然提供澄清指導.
   - 確保每個原則部分: 簡潔的名稱行、捕獲不可協商規則的段落(或專案符號列表)、如果不明顯則提供明確的理由.
   - 確保治理部分列出修改程式、版本控制策略和合規審查期望.

4. 一致性傳播檢查清單(將先前的檢查清單轉換為主動驗證):
   - 讀取 `/templates/plan-template.md` 並確保任何"章程檢查"或規則與更新的原則保持一致.
   - 讀取 `/templates/spec-template.md` 進行範圍/需求對齊——如果章程新增/刪除強制部分或約束, 則更新.
   - 讀取 `/templates/tasks-template.md` 並確保任務分類反映新的或刪除的原則驅動的任務型別(例如, 可觀測性、版本控制、測試紀律).
   - 讀取 `/templates/commands/*.md` 中的每個命令檔案(包括此檔案)以驗證在需要通用指導時沒有過時的引用(如僅限 CLAUDE 的代理特定名稱).
   - 讀取任何執行時指導文件(例如 `README.md`、`docs/quickstart.md` 或代理特定指導檔案(如果存在)). 更新對已更改原則的引用.

5. 生成同步影響報告(在更新後作為 HTML 註釋前置到章程檔案頂部): 
   - 版本更改: 舊版本 → 新版本
   - 修改的原則列表(如果重新命名, 則為舊標題 → 新標題)
   - 新增的部分
   - 刪除的部分
   - 需要更新的模板(✅ 已更新 / ⚠ 待處理)及檔案路徑
   - 如果有任何佔位符故意延遲, 則提供後續 TODO.

6. 最終輸出前的驗證: 
   - 沒有剩餘的未解釋的括號標記.
   - 版本行與報告匹配.
   - 日期採用 ISO 格式 YYYY-MM-DD.
   - 原則是宣告性的、可測試的, 並且沒有模糊語言("should" → 在適當的地方用 MUST/SHOULD 理由替換).

7. 將完成的章程寫回 `/memory/constitution.md`(覆蓋).

8. 向用戶輸出最終摘要, 包括:
   - 新版本和遞增理由.
   - 任何標記為手動後續處理的檔案.
   - 建議的提交訊息(例如 `docs: amend constitution to vX.Y.Z (principle additions + governance update)`).

格式和樣式要求:
- 完全按照模板使用 Markdown 標題(不要降級/升級級別).
- 換行長理由行以保持可讀性(理想情況下 <100 個字元), 但不要用尷尬的換行強制執行.
- 在部分之間保持單個空行.
- 避免尾隨空白.

如果使用者提供部分更新(例如, 僅一個原則修訂), 仍然執行驗證和版本決策步驟.

如果缺少關鍵資訊(例如, 批准日期確實未知), 請插入 `TODO(<FIELD_NAME>): explanation` 幷包含在同步影響報告中的延遲項下.

不要建立新模板; 始終操作現有的 `/memory/constitution.md` 檔案.
